<div *ngIf="showReferralWarning" class="row m-t-10">
  <div class="col-xs-12">
    <div class="alert bg-purple fade in mb-1" role="alert">
      <div class="row">
        <div class="col-xs-12">
          <strong>New referral program!</strong> Earn <b>$1</b> for every referral that applies and
          <b>${{valueBonusApproved}}</b> for every referral approved, plus bonuses. There is no limit to how much you
          can earn.
          <br class="hidden-sm-up"><br class="hidden-sm-up"> (
          <a class="alert-link text-underline" [routerLink]="['/dashboard/referrals']" (click)="saveLogPipe()">Click
            here to learn more</a>)
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-xl-12">
    <div class="row">
      <div class="col-xl-12">
        <div class="m-t-0 overflow-hidden">
          <div class="card-body">
            <div class="card-block p-0 p-t-5 cleartfix">

              <div class="row">

                <div class="col-xl-12 col-lg-12 col-xs-12">
                  <div class="row">

                    <div class="col-xl-4 col-lg-4 col-xs-12" *ngIf="isMobile()">
                      <hr />
                    </div>
                    <div class="col-xl-4 col-lg-4 col-xs-12 p-5 p-b-10">
                      <div class="card p-10 m-0">
                        <div class="card-body">
                          <div class="card-block p-b-10 p-t-10">
                            <div class="row media">
                              <div class="media-left media-top">
                                <i class="icon-badge blue-grey lighten-4 font-large-2 float-xs-left"></i>
                              </div>
                              <div class="media-body text-xs-center">
                                <span class="f-s-small">
                                  {{model.numberReferralApplied}} Referrals Applied
                                  <i class="fa fa-question-circle"
                                    [ngbPopover]="'Earn $1 for each applied referral plus $10 for every 10 referrals.'"
                                    triggers="mouseenter:mouseleave" popoverTitle="Bonus"></i>
                                </span>
                                <h2><b>{{model.totalReferralApplied | currency}}</b></h2>
                              </div>
                            </div>
                            <div class="row text-xs-center">
                              <div class="col-xs-12">
                                <div class="row">
                                  <div class="col-xs-12 p-0">
                                    <div class="progress-container">
                                      <div class="progress-bar-container p-l-5">
                                        <div class="progress">
                                          <div class="progress-bar bg-warning" role="progressbar" aria-valuemin="0"
                                            aria-valuemax="100" [style.width.%]="model.percentApplied">
                                            &nbsp;{{model.percentApplied}}%</div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="row small p-t-5">
                                  +{{model.numberNextBonusApplied}} applications needed for next bonus
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-xs-12" *ngIf="isMobile()">
                      <hr />
                    </div>
                    <div class="col-xl-4 col-lg-4 col-xs-12 p-5 p-b-10">
                      <div class="card p-10 m-0">
                        <div class="card-body">
                          <div class="card-block p-b-10 p-t-10">
                            <div class="row media">
                              <div class="media-left media-top">
                                <i class="fa fa-check-circle-o blue-grey lighten-4 font-large-2 float-xs-left"></i>
                              </div>
                              <div class="media-body text-xs-center">
                                <span class="f-s-small">
                                  {{model.numberReferralApproved}} Referrals Approved
                                  <i class="fa fa-question-circle"
                                    [ngbPopover]="'Earn ${{valueBonusApproved}} for each approved referral plus bonus. ' + textBonusList"
                                    triggers="mouseenter:mouseleave" popoverTitle="Bonus"></i>
                                </span>
                                <h2><b>{{model.totalReferralApproved | currency}}</b></h2>
                              </div>
                            </div>
                            <div class="row text-xs-center">
                              <div class="col-xs-12">
                                <div class="row">
                                  <div class="col-xs-12 p-0">
                                    <div class="progress-container">
                                      <div class="progress-bar-container">
                                        <div class="progress">
                                          <div class="progress-bar bg-warning" role="progressbar" aria-valuemin="0"
                                            aria-valuemax="100" [style.width.%]="model.percentApproved">
                                            &nbsp;{{model.percentApproved}}%</div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="row small p-t-5">
                                  +{{model.numberNextBonusApproved}} referrals needed for next bonus
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-xs-12" *ngIf="isMobile()">
                      <hr />
                    </div>
                    <div class="col-xl-4 col-lg-4 col-xs-12 p-5 p-b-10">
                      <div class="card p-10 m-0">
                        <div class="card-body">
                          <div class="card-block p-b-5 p-t-10">
                            <div class="row media">
                              <div class="media-left media-top">
                                <i class="fa fa-money blue-grey lighten-4 font-large-2 float-xs-left"></i>
                              </div>
                              <div class="media-body text-xs-center">
                                <span class="f-s-small">Total Earned</span>
                                <h2><b>{{model.totalEarned | currency}}</b></h2>
                              </div>
                            </div>
                            <div class="row small">
                              Earnings this week: {{model.currentEarned | currency}}
                            </div>
                            <div class="row small">
                              Commission earned last week: {{model.lastCommissionEarned | currency}}
                            </div>
                            <div class="row small">
                              <a [routerLink]="['/dashboard/referral-past-payments']">(Details)</a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-xs-12" *ngIf="isMobile()">
                      <hr />
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-xl-8 col-lg-8 col-xs-12">
                      <div class="row">
                        <app-referral-widget #referralWidget (onCallbackPainels)="onCallbackPainels($event)"
                          [page]="page"></app-referral-widget>
                      </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-xs-12 p-l-5 p-r-5">
                      <div class="row">
                        <div class="col-xs-12">
                          <div class="card p-10 m-0">
                            <div class="card-body">
                              <div class="card-block p-b-10 p-t-10">
                                <div class="row text-xs-center">
                                  <div class="col-xs-12">
                                    <h4 class="m-b-20 text-xs-center">How many coworkers can you refer?</h4>
                                    <input type="text" class="inputCalculator" NumbersOnly
                                      class="form-control form-control-lg w-100 text-xs-center"
                                      placeholder="Insert # here" #inputNumberReferrals
                                      [(ngModel)]="calculatorNumberReferrals"
                                      (keydown)="calculatorNumberReferrals = $event.target.value; onKeydownCalculatorEvent($event)" />

                                    <a href="javascript:void(0)" class="btn btn-md btn-orange aCalculate w-100 m-t-25"
                                      (click)="openCalculatorModal()">
                                      Calculate how much I can earn
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                  </div>

                  <div class="row" *ngIf="isMobile()">
                    <hr />
                  </div>
                </div>
                <div class="col-xl-12 col-lg-12 col-xs-12" *ngIf="isMobile()">
                  <hr />
                </div>
              </div>

            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #calculatorModal let-c="close" let-d="dismiss">
  <div class="row">
    <div class="col-xl-12">
      <div class="modal-header">
        <div class="row">
          <div class="col-xs-12">
            <h4>Calculate How Much You Can Earn</h4>
          </div>
        </div>
      </div>
      <div class="modal-body text-xs-center">
        <div class="row">
          <div class="col-xs-12">
            <h4 class="m-b-20 font-weight-bold">How many coworkers can you refer?</h4>
            <input type="text" class="inputCalculator" NumbersOnly
              class="form-control form-control-lg w-100 text-xs-center" placeholder="Insert # here"
              #inputNumberReferrals [(ngModel)]="calculatorNumberReferrals"
              (keyup)="calculatorNumberReferrals = $event.target.value; calculator(true)" />
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <hr>
          </div>
        </div>
        <div class="row">
          <div class="col-xl-12">
            <div class="bmglp_calculator_v2_col2">
              <div class="bmglp_calculator_v2_container">
                <p>Referrals that Applied: <strong>{{calculatorNumberReferrals}}</strong></p>
                <p>Earnings for Applicants: <strong>${{totalCashEarnedApplied}}</strong></p>
                <p>Bonus for Applicants : <strong>${{bonusCashEarnedApplied}}</strong></p>
              </div>
              <div class="bmglp_calculator_v2_container">
                <p>Referrals that were approved: <strong>{{calculatorNumberReferrals}}</strong>*</p>
                <p>Earnings for Approvals : <strong>${{totalCashEarnedApproved}}</strong></p>
                <p>Bonus for Approvals : <strong>${{bonusCashEarnedApproved}}</strong></p>
              </div>
              <div class="bmglp_calculator_v2_container">
                <p>Total: <strong>${{calculatorTotalCashEarned}}</strong></p>
              </div>
              <p class="bmglp_calculator_v2_text">
                *Not all referrals that applied for a loan will be approved for a loan
              </p>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <hr>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <a [href]="referralPageUrl" target="_blank">Learn more about earnings and bonus</a>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-dark"
          (click)="c('Close click');closeCalculatorModal()">Close</button>
      </div>
    </div>
  </div>
</ng-template>
